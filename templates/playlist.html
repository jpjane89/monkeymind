{% extends 'base.html' %}

{% block header %}

<div class = 'playlist-header'>
    <form class="options-form"  method="POST">
      <label for="autocomplete" id= 'options-label' >Select a playlist for your session: </label>
      <input id="autocomplete" name="playlist"> <button id="playlist-submit" class="btn btn-default">Submit</button>
    </form>
</div>

{% endblock %}

{% block body %}
  <div class="playlist-stats">
    <div class='table-header'>
    <h3> You focus best listening to...</h3>
    </div>
    <table class="table table-hover">
      <thead>
        <tr>
          <th>#</th>
          <th>Playlist</th>
          <th>Listen count</th>
        </tr>
      </thead>
      <tbody>
         {% set order_num = 1 %}   
         {% for playlist in playlists %}
         <tr>
          <td>{{ order_num }}
          <td>{{ playlist['name'] }}</td>
          <td>{{ playlist['count'] }}</td>
         </tr>
         {% set order_num = order_num + 1 %} 
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}

{% block script %}

<script type="text/javascript">

function getPlaylists() {
    $.get("/ajax/playlists", addToAutocomplete);
}

function addToAutocomplete(data) {
    var playlists = JSON.parse(data);
    $("#autocomplete" ).autocomplete({
    source: playlists
            });
}

function main() {
    getPlaylists();
}

$(main);
</script>

{% endblock %}